{{!-- Citation for use of AI Tools:
Date: 11/11/25
source: chatgpt.com
prompt: create a pop up confirmation message for the database reset link. --}}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="icon" href="/images/bookmark.png" type="image/png">
    <title>CS340 - Library Project</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1> <img src="/images/library.png" alt="Site Logo" style="width:75px; height:auto;">
     BCPM Library Management System</h1>
    <nav>
        Navigation: 
        <a href="/">Home</a>
        <a href="/members">Members</a>
        <a href="/books">Books</a>
        <a href="/order-details">Books Checked Out</a>
        <a href="#" id="resetDbLink" style="color:red;">Reset Database</a>
    </nav>

    {{{body}}}

</body>
<footer>
    <hr>
    <p>&copy; 2025 BCPM Library</p>
    <a href="https://www.flaticon.com/free-icons/library" title="library icons">Library icons created by Smashicons - Flaticon</a>
</footer>
</html>


<script>
  (function () {
    const link = document.getElementById('resetDbLink');
    if (!link) return;

    link.addEventListener('click', async (e) => {
      e.preventDefault();

      const confirmed = confirm(
        'Really reset the database?\n\nThis will DROP and RECREATE tables, then seed data.'
      );
      if (!confirmed) return;

      // disable while running
      link.textContent = 'Resetting…';
      link.style.pointerEvents = 'none';

      try {
        const res = await fetch('/api/reset-db', { method: 'POST' });
        if (!res.ok) {
          const msg = await res.text();
          alert('Reset failed: ' + msg);
        } else {
          alert('✅ Database reset successful!');
          // Optional: refresh current page data
          window.location.reload();
        }
      } catch (err) {
        alert('Reset failed: ' + (err?.message || err));
      } finally {
        link.textContent = '⚠️ Reset Database';
        link.style.pointerEvents = 'auto';
      }
    });
  })();
</script>